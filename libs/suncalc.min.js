!function(){"use strict";function n(n){return n.valueOf()/I-.5+k}function t(n){return new Date((n+.5-k)*I)}function e(t){return n(t)-z}function r(n,t){return T(P(n)*D(C)-y(t)*P(C),D(n))}function a(n,t){return H(P(t)*D(C)+D(t)*P(C)*P(n))}function u(n,t,e){return T(P(n),D(n)*P(t)-y(e)*D(t))}function i(n,t,e){return H(P(t)*P(e)+D(t)*D(e)*D(n))}function o(n,t){return E*(280.16+360.9856235*n)-t}function c(n){return 0>n&&(n=0),2967e-7/Math.tan(n+.00312536/(n+.08901179))}function d(n){return E*(357.5291+.98560028*n)}function s(n){var t=E*(1.9148*P(n)+.02*P(2*n)+3e-4*P(3*n)),e=102.9372*E;return n+t+e+p}function f(n){var t=d(n),e=s(t);return{dec:a(e,0),ra:r(e,0)}}function l(n,t){return Math.round(n-U-t/(2*p))}function h(n,t,e){return U+(n+t)/(2*p)+e}function M(n,t,e){return z+n+.0053*P(t)-.0069*P(2*e)}function v(n,t,e){return b((P(n)-P(t)*P(e))/(D(t)*D(e)))}function g(n,t,e,r,a,u,i){var o=v(n,e,r),c=h(o,t,a);return M(c,u,i)}function m(n){var t=E*(218.316+13.176396*n),e=E*(134.963+13.064993*n),u=E*(93.272+13.22935*n),i=t+6.289*E*P(e),o=5.128*E*P(u),c=385001-20905*D(e);return{ra:r(i,o),dec:a(i,o),dist:c}}function w(n,t){return new Date(n.valueOf()+t*I/24)}var p=Math.PI,P=Math.sin,D=Math.cos,y=Math.tan,H=Math.asin,T=Math.atan2,b=Math.acos,E=p/180,I=864e5,k=2440588,z=2451545,C=23.4397*E,O={};O.getPosition=function(n,t,r){var a=E*-r,c=E*t,d=e(n),s=f(d),l=o(d,a)-s.ra;return{azimuth:u(l,c,s.dec),altitude:i(l,c,s.dec)}};var S=O.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];O.addTime=function(n,t,e){S.push([n,t,e])};var U=9e-4;O.getTimes=function(n,r,u){var i,o,c,f,v,m=E*-u,w=E*r,p=e(n),P=l(p,m),D=h(0,m,P),y=d(D),H=s(y),T=a(H,0),b=M(D,y,H),I={solarNoon:t(b),nadir:t(b-.5)};for(i=0,o=S.length;o>i;i+=1)c=S[i],f=g(c[0]*E,m,w,T,P,y,H),v=b-(f-b),I[c[1]]=t(v),I[c[2]]=t(f);return I},O.getMoonPosition=function(n,t,r){var a=E*-r,d=E*t,s=e(n),f=m(s),l=o(s,a)-f.ra,h=i(l,d,f.dec),M=T(P(l),y(d)*D(f.dec)-P(f.dec)*D(l));return h+=c(h),{azimuth:u(l,d,f.dec),altitude:h,distance:f.dist,parallacticAngle:M}},O.getMoonIllumination=function(n){var t=e(n),r=f(t),a=m(t),u=149598e3,i=b(P(r.dec)*P(a.dec)+D(r.dec)*D(a.dec)*D(r.ra-a.ra)),o=T(u*P(i),a.dist-u*D(i)),c=T(D(r.dec)*P(r.ra-a.ra),P(r.dec)*D(a.dec)-D(r.dec)*P(a.dec)*D(r.ra-a.ra));return{fraction:(1+D(o))/2,phase:.5+.5*o*(0>c?-1:1)/Math.PI,angle:c}},O.getMoonTimes=function(n,t,e,r){var a=new Date(n);r?a.setUTCHours(0,0,0,0):a.setHours(0,0,0,0);for(var u,i,o,c,d,s,f,l,h,M,v,g,m,p=.133*E,P=O.getMoonPosition(a,t,e).altitude-p,D=1;24>=D&&(u=O.getMoonPosition(w(a,D),t,e).altitude-p,i=O.getMoonPosition(w(a,D+1),t,e).altitude-p,d=(P+i)/2-u,s=(i-P)/2,f=-s/(2*d),l=(d*f+s)*f+u,h=s*s-4*d*u,M=0,h>=0&&(m=Math.sqrt(h)/(2*Math.abs(d)),v=f-m,g=f+m,Math.abs(v)<=1&&M++,Math.abs(g)<=1&&M++,-1>v&&(v=g)),1===M?0>P?o=D+v:c=D+v:2===M&&(o=D+(0>l?g:v),c=D+(0>l?v:g)),!o||!c);D+=2)P=i;var y={};return o&&(y.rise=w(a,o)),c&&(y.set=w(a,c)),o||c||(y[l>0?"alwaysUp":"alwaysDown"]=!0),y},"function"==typeof define&&define.amd?define(O):"undefined"!=typeof module?module.exports=O:window.SunCalc=O}();
